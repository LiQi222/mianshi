<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录/注册 - AI 面试官</title>
    <style>
        :root {
            --primary-color: #4A90E2; --primary-light: #eaf2fc; --secondary-color: #50E3C2;
            --background-color: #f7f9fc; --text-color: #4a4a4a; --light-text-color: #9b9b9b;
            --container-bg: #ffffff; --border-color: #e6e6e6; --shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            --border-radius: 12px;
        }
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background-color: var(--background-color); color: var(--text-color); line-height: 1.7; margin: 0; }
        .hidden { display: none !important; }
        
        .auth-wrapper { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .auth-container { width: 100%; max-width: 400px; background-color: var(--container-bg); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 40px; box-sizing: border-box; }
        .auth-header { text-align: center; margin-bottom: 30px; }
        .auth-header h1 { font-size: 28px; color: var(--primary-color); }
        .auth-form input { width: 100%; padding: 14px; border: 1px solid var(--border-color); border-radius: 8px; box-sizing: border-box; font-size: 16px; margin-bottom: 15px; }
        .auth-form button { width: 100%; padding: 14px; background: var(--primary-color); color: #fff; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; transition: background-color 0.3s, transform 0.1s; }
        .auth-form button:hover { background-color: #357ABD; }
        .auth-form button:active { transform: scale(0.98); }
        .auth-switch { text-align: center; margin-top: 20px; color: var(--light-text-color); }
        .auth-link { color: var(--primary-color); text-decoration: none; cursor: pointer; font-weight: 500; }
        .auth-link:hover { text-decoration: underline; }
        .error-message { color: #D0021B; text-align: center; margin-bottom: 15px; font-size: 14px; min-height: 20px;}
        .validation-hint { font-size: 12px; color: var(--light-text-color); margin-top: -10px; margin-bottom: 15px; text-align: left; padding-left: 5px; }
        .terms { margin-top: 15px; font-size: 13px; color: var(--light-text-color); }
        .terms input { margin-right: 5px; }
    </style>
</head>
<body>
    <div class="auth-wrapper">
        <div class="auth-container">
            <div id="login-form-container">
                <div class="auth-header"><h1>欢迎回来</h1><p>登录以继续您的AI面试准备</p></div>
                <form id="login-form" class="auth-form">
                    <div id="login-error" class="error-message"></div>
                    <input type="text" id="login-username" placeholder="用户名" required>
                    <input type="password" id="login-password" placeholder="密码" required>
                    <button type="submit">登 录</button>
                </form>
                <div class="auth-switch">还没有账户？ <a href="#" id="show-register-link" class="auth-link">立即注册</a></div>
            </div>
            <div id="register-form-container" class="hidden">
                <div class="auth-header"><h1>创建新账户</h1><p>开启您的个性化面试之旅</p></div>
                <form id="register-form" class="auth-form">
                    <div id="register-error" class="error-message"></div>
                    <input type="text" id="register-username" placeholder="用户名" required>
                    <div class="validation-hint">5-10位，仅限英文字母和数字</div>
                    <input type="password" id="register-password" placeholder="密码" required>
                    <div class="validation-hint">6-18位，必须包含英文和数字</div>
                    <div class="terms">
                        <input type="checkbox" id="terms-agree" required> 我已阅读并同意 
                        <a href="/agreement" target="_blank" class="auth-link">用户协议</a> 和 
                        <a href="/privacy" target="_blank" class="auth-link">隐私政策</a>
                    </div>
                    <button type="submit" id="register-submit-btn" disabled>注 册</button>
                </form>
                <div class="auth-switch">已有账户？ <a href="#" id="show-login-link" class="auth-link">返回登录</a></div>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loginContainer = document.getElementById('login-form-container');
            const registerContainer = document.getElementById('register-form-container');
            const showError = (elId, msg) => { document.getElementById(elId).textContent = msg || ''; };

            document.getElementById('show-register-link').addEventListener('click', (e) => {
                e.preventDefault();
                loginContainer.classList.add('hidden');
                registerContainer.classList.remove('hidden');
            });

            document.getElementById('show-login-link').addEventListener('click', (e) => {
                e.preventDefault();
                registerContainer.classList.add('hidden');
                loginContainer.classList.remove('hidden');
            });

            document.getElementById('terms-agree').addEventListener('change', (e) => {
                document.getElementById('register-submit-btn').disabled = !e.target.checked;
            });

            document.getElementById('register-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                const password = document.getElementById('register-password').value;
                const response = await fetch('/api/register', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username, password }) });
                const data = await response.json();
                if (response.ok) {
                    alert('注册成功！请登录。');
                    registerContainer.classList.add('hidden');
                    loginContainer.classList.remove('hidden');
                    showError('register-error', '');
                } else {
                    showError('register-error', data.error);
                }
            });

            document.getElementById('login-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                const response = await fetch('/api/login', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username, password }) });
                const data = await response.json();
                if (response.ok) {
                    window.location.href = '/';
                } else {
                    showError('login-error', data.error);
                }
            });
        });
    </script>
</body>
</html>